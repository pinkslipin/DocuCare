<h2>Process Payment for {{ billing_record.service_description }}</h2>
<p>Amount Due: {{ billing_record.balance_due }}</p>
<form method="post" onsubmit="return validatePayment()">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Submit Payment</button>
    <a href="{% url 'home' %}">Back to Home</a>
</form>

<script>
    function validatePayment() {
        // Get the value of the payment amount field and convert it to a number
        const paymentAmount = parseFloat(document.querySelector('input[name="payment_amount"]').value);
        
        // Balance due is rendered by Django as a JavaScript-friendly value
        const balanceDue = parseFloat("{{ billing_record.balance_due|floatformat:2 }}");
        
        // Check if the payment amount exceeds the balance due
        if (paymentAmount > balanceDue) {
            alert("Payment amount cannot exceed balance due.");
            return false;  // Prevent form submission
        }
        return true;  // Allow form submission
    }
</script>
